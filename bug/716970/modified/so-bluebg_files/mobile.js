StackExchange.mobile=function(){var a=function(){$(".submit-on-change").change(function(){$(this).closest("form").submit()})};var u=function(){$(".searchbox").focus(function(){if($(this).val()=="search"){$(this).val("")}})};var o=function(y){var w=$(".unreadCount");var x=$(".site-menu-wrap");x.hide().removeClass("dno");$("#user-dropdown").toggle(function(){x.show();if(y){k()}$(this).text("▲");$(this).addClass("menu-arrow-on");w.remove()},function(){x.hide();$(this).text("▼");$(this).removeClass("menu-arrow-on")});w.click(function(){$("#user-dropdown").click()});$(".close-link").click(function(){$("#user-dropdown").click()})};var g=false;var k=function(){if(g){return}g=true;StackExchange.mobile.addSpinner(".site-menu");$.ajax({url:"/inbox/genuwine",success:function(y,w,x){StackExchange.mobile.removeSpinner(".site-menu");j(y)},dataType:"json",error:function(y,x,w){StackExchange.mobile.removeSpinner(".site-menu")}})};var j=function(A){var D=$(".site-menu");var w=false;var E=false;var z='<table class="inbox" cellspacing="0">';for(var F=0;F<A.length&&F<10;F++){var C='<tr class="inbox-item '+(A[F].IsNew?"inbox-item-new":"")+'">';C+='<td class="site-icon">';C+='<img src="'+A[F].FaviconUrl+'"/>';C+="</td>";C+='<td class="inbox-msg-wrap '+(A[F].IsNew?"inbox-msg-new":"")+'">';C+='<span class="inbox-link">';if(A[F].Type=="careers message"){C+="<a "+G+' style="font-weight:normal"><b>'+A[F].Title+"</b> wants to contact you on <b>Stack Overflow Careers</b></a>"}else{if(A[F].Type=="invitation"){var y=A[F].Count;var x="invitation"+(y>1?"s":"");C+="<a "+G+' style="font-weight:normal"><b>'+y+"</b> "+x+" awarded on <b>Stack Overflow Careers</b></a>"}else{var B=A[F].Count;var G='href="'+A[F].Url+'"';C+=(B>1?B+" ":"")+A[F].Type+" on <a "+G+">"+A[F].Title+"</a>"}}C+="</span>";C+="<br>";C+='<span class="inbox-msg">'+A[F].Summary+"</span>";C+="</td>";C+="</tr>";z+=C;if(!A[F].IsNew){w=true}else{E=true}}z+="</table>";$(".site-menu-links").before($(z));if(!E){$(".inbox-item").hide();$(".inbox-item:lt(2)").show()}else{$(".inbox-item-new").show()}if(w){var H=$('<span style="float:left"><a>show more inbox messages</a></span>');H.click(function(){$(".inbox-item").show();$(this).detach()});$(".site-menu-links").prepend(H)}D.show()};var t=null;var f=function(){if(t!=null){return}t=setInterval(function(){var z=$(".dot1");var x=$(".dot2");var y=$(".dot3");var w=$(".dot4");if(!(e(z,".dot2")||e(x,".dot3")||e(y,".dot4")||e(w))){$.each(z,function(B,A){var C=$(A).closest(".mobile-spinner").attr("spinnerPadding");$(A).css({paddingLeft:C+"px"})})}},20)};var i=function(){if(t!=null&&$(".mobile-spinner").length==0){clearInterval(t);t=null}};var e=function(x,w){var y=false;$.each(x,function(F,A){var E=$(A);var D=E.css("padding-left");if(D==null||D=="0px"){return}var z=+D.substring(0,D.length-2);z--;E.css({paddingLeft:z+"px"});if(w){var C=E.siblings(w);var B=C.css("padding-left");B=+B.substring(0,B.length-2);B++;C.css({paddingLeft:B+"px"})}y=true});return y};var l=function(){$(".spoiler").each(function(x,y){var w=$(y);w.removeClass("spoiler").addClass("spoiler-overlay");var z=w.children();z.remove();w.append('<div class="spoiler-click-to-show">Click to show spoiler</div>');w.one("click",function(){w.empty();w.append(z);w.removeClass("spoiler-overlay").addClass("spoiler")})})};var q=function(x,E,B,y){var C=x.val();var D=C.lastIndexOf(" ",B);var w=C.indexOf(" ",y);if(D==-1){D=0}else{D++}if(w==-1){w=C.length+1}var A=C.substring(0,D)+E+C.substring(w);x.val($.trim(A));var z=D+E.length+1;if(z>A.length){x.val(x.val()+" ")}x.focus()[0].setSelectionRange(z,z)};var s={};var r=function(A,y,z,D,w){var B=s[A];if(B){if(B.clear){y();return}var x=B.tags;for(var C=0;C<x.length;C++){if(x[C]==A&&x[C].length>3){y();return}}z(x,D,w);return}$.get("/filter/tags",{q:A},function(H,I,E){if(!$.trim(H)){s[A]={clear:true};y();return}var G=H.split("\n");var F=[];for(var J=0;J<G.length;J++){var K=G[J].split("|");F[F.length]=K[0]}s[A]={tags:F};for(var J=0;J<F.length;J++){if(F[J]==A&&F[J].length>3){y();return}}z(F,D,w)})};var m=function(A){var y=A.siblings(".mobile-tag-autocomplete");var w=function(){y.hide()};var x=function(B,E,F){y.empty();for(var D=0;D<B.length&&D<5;D++){var C=$('<a class="post-tag"></a>');C.text(B[D]);C.one("click",(function(G,H,I){return function(){w();q(A,G,H,I)}})(B[D],E,F));y.append(C);y.append($("<span>&nbsp;</span>"))}y.show()};var z="";return function(){var E=A.val();if(!E||!$.trim(E)){w();return}z=E;var B=A[0].selectionStart;if(E[B-1]==" "){w();return}var C=E.lastIndexOf(" ",B-1);if(C==-1){C=0}var F=E.indexOf(" ",C+1);if(F==-1){F=E.length}var D=$.trim(E.substring(C,F));r(D,w,x,C,F)}};var v=function(){if($.browser.msie){return}$(".mobile-tag-field").each(function(w,y){var z=$(y);var A=m(z);var x=setInterval(A,500);z.keyup(function(B){if(x){clearInterval(x)}if(B.which==32||B.which==13){A()}x=setInterval(A,500)})})};var h=function(x,y,w){return function(){$.get("/posts/popup/close/"+y,null,function(D,A,C){var B=$(D);B.find(".edit-field-overlay").remove();x.empty();x.append(B);x.show();var z=w.offset();scrollTo(0,z.top);StackExchange.vote_closingAndFlagging.close_initPopup(B,w,$("#does-not-exist"));B.find(".popup-close > a").unbind("click").click(function(){$(".util-link-active").removeClass("util-link-active");w.parent().removeClass("clear-bottom-padding");x.hide()});$(".popup-actions-cancel").hide();B.find(".edit-field-overlay, .popup-actions-cancel, .actual-edit-overlay").remove();B.find(".edit-field-overlayed").removeClass("edit-field-overlayed").attr("style","")})}};var n=function(){var w={};$("a.flag-link[id^='mobile-flag-post-']").each(function(B,C){var x=$(C);var y=+(x.attr("id").substring("mobile-flag-post-".length));var A=$("#mod-menu-"+y);var z=function(D){var E;x.loadPopup({url:"/posts/popup/flag/"+y,loaded:function(G){E=G;G.detach();A.empty();A.append(G);A.show();var F=x.offset();scrollTo(0,F.top);StackExchange.vote_closingAndFlagging.flag_loaded(G);StackExchange.vote_closingAndFlagging.on_close_click(h(A,y,x));x.addClass("util-link-active");x.parent().addClass("clear-bottom-padding");G.find(".popup-close > a").unbind("click").click(function(){$(".util-link-active").removeClass("util-link-active");x.parent().removeClass("clear-bottom-padding");A.hide()})},hideDescriptions:true,actionSelected:StackExchange.vote_closingAndFlagging.flag_actionSelected,subformShow:function(F){StackExchange.vote_closingAndFlagging.flag_subformShow(F);E.attr("style","");E.find(".edit-field-overlay, .popup-actions-cancel, .actual-edit-overlay").remove();E.find(".edit-field-overlayed").removeClass("edit-field-overlayed").attr("style","");if(D&&$.isFunction(D)){D(E)}}})};w[y]=z;x.click(z)});return w};var c=function(w){$("a.post-close-link[id^='mobile-close-post-']").each(function(x,z){var y=$(z);var A=+(y.attr("id").substring("mobile-close-post-".length));var B=w[A];y.click(function(){B(function(C){C.hide();C.find("#flag-load-close").click();$("#mobile-flag-post-"+A).removeClass("util-link-active");$("#mobile-close-post-"+A).addClass("util-link-active")})})})};var d=function(){$(".delete-post").each(function(w,y){var x=$(y);var z=+(x.attr("id").substring("delete-post-link-".length));x.click(function(){if(!confirm("Vote to delete this post?")){return}StackExchange.vote.submit(x,z,StackExchange.vote.voteTypeIds.deletion,function(){window.location.reload()})})});$(".restore-post").each(function(w,y){var x=$(y);var z=+(x.attr("id").substring("delete-post-link-".length));x.click(function(){if(!confirm("Vote to undelete this post?")){return}StackExchange.vote.submit(x,z,StackExchange.vote.voteTypeIds.undeletion,function(){window.location.reload()})})})};var b=function(){$(".post-reopen-link").each(function(w,y){var x=$(y);var z=+(x.attr("id").substring("mobile-close-post-".length));x.click(function(){if(!confirm("Nominate this question for reopening?")){return}StackExchange.vote.submit(x,z,StackExchange.vote.voteTypeIds.reopen,function(){window.location.reload()})})})};var p=function(){$(".post-moderator-link").each(function(w,y){var x=$(y);var z=+(x.attr("id").substring("mobile-post-moderator-link-".length));var A=$("#mod-menu-"+z);x.click(function(){x.loadPopup({url:"/admin/posts/"+z+"/moderator-menu",loaded:function(C){outerPopup=C;C.detach();A.empty();A.append(C);StackExchange.moderator.initMenu(C);C.find("div.subheader, div.popup-tab-content[id^=tab-dev-actions-], div.popup-tab-content[id^=tab-dev-info-], .actual-edit-overlay").hide();C.find(".action-subform").hide();C.find("#master-question-id").attr("style","");A.show();var B=x.offset();scrollTo(0,B.top);x.addClass("util-link-active");x.parent().addClass("clear-bottom-padding");C.find(".popup-close > a").unbind("click").click(function(){$(".util-link-active").removeClass("util-link-active");x.parent().removeClass("clear-bottom-padding");A.hide()})},hideDescriptions:true,dontCenter:true})})})};return{initDraft:function(D,w,H,A){if(!window.localStorage){return}var G=$(w);var E=$(G.find(".wmd-input")[0]);var z=G.find(".tagnames");var C=G.find(".title");if(z.length>0){z=$(z[0])}if(C.length>0){C=$(C[0])}var x="mobile-draft-"+D;var F=window.localStorage[x];if(F){F=JSON.parse(F);E.val(F.body);C.val(F.title);z.val(F.tags)}var y=function(){if(E.val()||C.val()||z.val()){window.localStorage[x]=JSON.stringify({body:E.val(),title:C.val(),tags:z.val()})}else{window.localStorage.removeItem(x)}};if(A){y()}var B=setInterval(y,5000);$(H).click(function(){clearInterval(B);window.localStorage.removeItem(x)});E.blur(y);z.blur(y);C.blur(y)},applyTagPrefs:function(y,w,x){$(".post-tag").each(function(B,E){var A=$(E);if(w){var C=false;for(var D=0;D<w.length;D++){if(A.text()==w[D]){C=true;break}}if(C){var F=A.parents(".question-summary");F.addClass("tagged-ignored");if(x){F.hide()}}}if(y){var z=false;for(var D=0;D<y.length;D++){if(A.text()==y[D]){z=true;break}}if(z){var F=A.parents(".question-summary");F.addClass("tagged-interesting")}}})},shrinkAndShowMore:function(w,x){$(w).each(function(z,y){var A=$(y);if(A.height()<=x){return}var C={overflowY:A.css("overflow-y"),maxHeight:A.css("max-height")};A.css({overflowY:"hidden",maxHeight:x+"px"});var B=$('<div class="generic-show-more"><a>show more</a></div>');A.after(B);B.click(function(){B.remove();A.css(C)});B.css({backgroundColor:A.css("background-color"),fontSize:"12px"})})},addSpinner:function(w,x){$(w).each(function(B,z){if(!x){x="loading"}var C=$('<span class="mobile-spinner"><span class="spinner-message"></span><span class="dot1">.</span><span class="dot2">.</span><span class="dot3">.</span><span class="dot4">.</span></span>');$(z).append(C);$(C).find(".spinner-message").text(x);var y=$(C).find(".dot1").width()+$(C).find(".dot2").width()+$(C).find(".dot3").width();var D=$(C).find(".spinner-message").width();var A=D+(y);$(C).css({width:A+"px",overflow:"hidden",display:"block"});$(C).find(".dot1").css({paddingLeft:(y*2)+"px"});$(C).find(".dot2").css({paddingLeft:"0px"});$(C).find(".dot3").css({paddingLeft:"0px"});$(C).find(".dot4").css({paddingLeft:"0px"});$(C).attr("spinnerPadding",y*2)});f()},removeSpinner:function(w){$(w).find(".mobile-spinner").remove();i()},init:function(w){$(function(){a();u();o(w);v();l();c(n());d();b();p()})}}}();