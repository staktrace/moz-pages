if(!jsConfig.get('board_script_url'))jsConfig.set('board_script_url',jsConfig.get('BaseURL')+'forum')
function ForumMainSearch(detailedSearchOptionsId){var searchForm=getById('mainSearch'),detailedSearchOptions=detailedSearchOptionsId&&getById(detailedSearchOptionsId),checkSearchInput=function(e){var selectedOption=detailedSearchOptions&&detailedSearchOptions[detailedSearchOptions.selectedIndex],selectedValue=selectedOption?selectedOption.value:'board',keywordField=searchForm.elements['keyword'],forumField,topicId;switch(selectedValue){case'board':case'forum':if((forumField=searchForm.elements['forumId[]']))forumField.disabled=selectedValue=='board';return true;break;case'topic':case'poster':if(!checkKeyword(keywordField)){keywordField.focus()}else if((topicId=selectedOption.getAttribute('data-topicid')))window.location.href=jsConfig.get('board_script_url')+'/list_messages/'+topicId+'?data%5Bfilter_'+(selectedValue=='topic'?'keywords':'userids')+'%5D='+escape(keywordField.value);break};e.preventDefault();return false};if(searchForm){addEvent(searchForm,'submit',checkSearchInput);window.mainSearchSuggest=new SearchSuggest('forum');if(detailedSearchOptions){var fancy=new FancySelect(detailedSearchOptions);window.mainSearchSuggest.addExecutionCallback(function(){return fancy.select.value=='board'||fancy.select.value=='forum'});window.mainSearchSuggest.setAdditionalParameterCallback(function(){if(fancy.select.value=='forum'&&searchForm.elements['forumId[]'])return'&forumId[]='+searchForm.elements['forumId[]'].value;return''});window.mainSearchSuggest.popupConfig.offsetLeft=-(fancy.element.offsetWidth+1)}}}
function FancySelect(select){this.select=select;this.element=null;this.currentOption=null;this.init()};Object.extend(FancySelect.prototype,{init:function(){this.element=document.createElement('div');this.element.className='fancySelect';var currentOptionWrapper=document.createElement('div');this.currentOption=document.createElement('span');this.currentOption.className='arrowDarkGreyDown';this.setCurrentOptionText();currentOptionWrapper.appendChild(this.currentOption);addEvent(currentOptionWrapper,'click',this.toggleSelect.bind(this));this.element.appendChild(currentOptionWrapper);var list=document.createElement('ul'),listItem,option,i=0;for(;(option=this.select.options[i]);i++){listItem=document.createElement('li');listItem.innerHTML='<span>'+option.text+'</span>';addEvent(listItem,'click',this.selectOption.bind(this,i));list.appendChild(listItem)};this.element.appendChild(list);this.select.parentNode.insertBefore(this.element,this.select);this.select.style.display='none';addEvent(document,'click',this.hideSelect.bind(this))},toggleSelect:function(e){toggleClass(this.element,'dropdown')},hideSelect:function(e){if(e&&this.element.contains(e.target))return;removeClass(this.element,'dropdown')},selectOption:function(selectedIndex,e){this.select.selectedIndex=selectedIndex;this.setCurrentOptionText();this.hideSelect()},setCurrentOptionText:function(){this.currentOption.innerHTML=this.select.options[this.select.selectedIndex].text}})
function winopen(url,winname,width,height,extra){winname=winname||'_blank';width=width||460;height=height||550;if(url.charAt(0)=='/')url=url.substr(1);if(!/^https?:\/\//.test(url))url=jsConfig.get('BaseURL')+url;var popup=window.open(url,winname,'toolbar=no,location=no,menubar=no,width='+width+',height='+height+',resizable=yes,status=no'+(extra?','+extra:''));try{popup.focus()}catch(e){}};var EMPTY=/^\s*$/,BIRTHDAY=/^(19|20)\d{2}-(0?[1-9]|1[012])-(0?[1-9]|[12]\d|3[01])$/,NODATE=/^0*(-0*){0,2}$/,NUMBER=/^\d+$/,EMAIL=/^[\w.?&;#~=%\/-]+@[\w-]+(\.[\w-]+){1,3}$/,URL=/^https?:\/\/[^\s]+$/
function switchpage(x,url,suffix){var s=getSelectedValue(x);if(s!='')window.location.href=url+'/'+s+(suffix?suffix:'')}
function switchforum(x){switchpage(x,jsConfig.get('board_script_url')+'/list_topics')}
function switchdestinationforum(x){return getSelectedValue(x)!=''}
function switchquotepage(formid,s){if(s!=''){var form=document.forms[formid];if(form){form.elements['data[offset]'].value=s;form.elements['data[type]'].value='pagethru';form.submit()}}}
function switchfaqpage(x){switchpage(x,jsConfig.get('board_script_url')+'/faq')}
function switchforumpage(x,forumid){switchpage(x,jsConfig.get('board_script_url')+'/list_topics/'+forumid)}
function switchcontactpage(form){switchpage(form.elements['data[offset]'],jsConfig.get('board_script_url')+'/list_contacts')}
function selectforum(x){var i=x.options.length;while(i--)if(x.options[i].id=='switchCat')x.options[i].selected=false}
function selectfavoriteforum(x,max){var s=0,i=x.length;if(!max)max=3;while(i--)if(x.options[i].id=='switchCat'){x.options[i].selected=false}else if(x.options[i].selected)if(++s>max)x.options[i].selected=false}
function clearforumlist(x){var i=x.options.length;while(i--)x.options[i].selected=false}
function bookmarkCheck(checkbox){var el=checkbox.form.elements,i=el.length,all_checked=true;while(i--)if(el[i].type=='checkbox'&&el[i].name!='checkem'&&!el.checked){all_checked=false;break};el.checkem.checked=all_checked}
function checkAllForId(checkboxId,checked){var checkbox=getById(checkboxId),el=checkbox.form[checkbox.name],i=el.length;while(i--)if(el[i].type=='checkbox')el[i].checked=checked}
function checkDelete(form,type){var el=form.elements,i=el.length;while(i--)if(el[i].type=='checkbox'&&el[i].name!='checkem'&&el[i].checked)return true;alert('Je hebt geen '+type+' geselecteerd om te verwijderen');return false}
function quote_title(messageid,user){if(window.topicname){if(topicname.length>40)topicname=topicname.substr(0,40)+'...';var title=user+' in "'+topicname+'"';putStr('[message='+messageid+']'+title.replace(/\[/g,'\\\[')+'[/message]\n')};return false}
function quote(string){putStr(string);return false}
function calcCharLeft_Fast(f,maxLength,s){var str=f.elements[s].value,len=str.length,re=/[&<>"']/g,c=re.exec(str);while(c!=null){switch(c[0]){case'&':len+=4;break;case'<':len+=3;break;case'>':len+=3;break;case'"':len+=5;break;case'\'':len+=5;break};c=re.exec(str)};if(len>maxLength){f.elements[s].value=calcCharLeft_Extended(maxLength,str);calcCharLeft_Fast(f,maxLength,s);return false};getById('charsleft').firstChild.nodeValue=maxLength-len;return true}
function calcCharLeft_Extended(maxLength,str){var i=0,j=str.length,len=0;do{switch(str.charAt(i)){case'&':len+=5;break;case'<':len+=4;break;case'>':len+=4;break;case'"':len+=6;break;case'\'':len+=6;break;default:len++}}while(len<=maxLength&&++i<j);return str.substring(0,i)}
function showtopic(topicid){if(topicid.match(/^[1-9]\d*$/)){window.open(jsConfig.get('board_script_url')+'/list_messages/'+topicid,'Topic')}else alert('Het topic id is geen getal of niet ingevuld.')}
function enableIds(x,name){var d=x.checked?'':'none',ch=document.getElementsByName(name),i=ch.length;while(i--)ch[i].parentNode.style.display=d}
function collectIds(form,name){var t=form.elements['data['+name+']'];if(t){var selectedIds=[],ch=document.getElementsByName(name),i=ch.length;while(i--)if(ch[i].checked)selectedIds.push(ch[i].value);t.value=selectedIds.join(',')}}
function checkIds(name){var ch=document.getElementsByName(name),i=ch.length;while(i--)ch[i].checked=true}
function selectContact(x,targetId){var y=getSelectedValue(x),t=x.form.elements[targetId];if(y&&t){if(y.contains("'")){y='"'+y+'"'}else if(NUMBER.test(y)||y.contains('"'))y="'"+y+"'";var contacts=t.value?t.value.split(/\s*,\s*/):[];if(!contacts.contains(y)){contacts[contacts.length]=y;t.value=contacts.join(', ')}}}
function checkpreferencesform(form){var element=form.elements['data[customcss]'];if(element&&!EMPTY.test(element.value)&&!URL.test(element.value)){alert('Ongeldige custom stylesheet url');element.focus();return false};var i=0,a={},value;while((element=form.elements[i++]))if(element.name&&element.name.startsWith('data[accesskeys]')){value=element.value.toLowerCase();if(value.length){if(!/^[a-z]$/.test(value)){alert('Ongeldig teken "'+value+'" voor accesskey "'+element.id+'"; alleen letters zijn toegestaan');element.focus();return false};if(value in a){alert('Accesskey "'+value+'" al gebruikt voor "'+a[value]+'"; je kan niet dezelfde key aan meerdere acties toekennen');element.focus();return false};a[value]=element.id;element.value=value}};element=form.elements['data[limit]'];if(!NUMBER.test(element.value)||parseInt(element.value,10)<=0){alert('Aantal berichten per pagina moet numeriek zijn en minimaal 1');element.focus();return false};return true}
function checkadminform(form,isalias){if(form.elements['data[delete]']&&form.elements['data[delete]'].checked)if(isalias||getSelectedValue(form.elements['data[delete_action]'])=='hard')return confirm('Weet je zeker dat je '+(isalias?'deze alias':'het hele topic')+' wilt deleten?');if(form.elements['data[status]']&&form.elements['data[status]'].checked)if(getSelectedValue(form.elements['data[statusid]'])=='Closed')trackEventWt('forumtopicClosed',0,true);if(!form.preview&&form.elements['data[content]'])return checknewmessageform(form);return true}
function checkquickreply(formname){var form=document.forms[formname||'quickreply_form'];if(form)if(!EMPTY.test(form.elements['data[content]'].value)){form.elements['data[type]'].value='preview';form.submit();return false};return true}
function checkedituserform(form){var s=form.elements['data[email]'];if(s&&!EMPTY.test(s.value)&&!EMAIL.test(s.value)){alert('Ongeldig email adres');s.focus();return false};s=form.elements['data[birthday]'];if(!NODATE.test(s.value)&&!BIRTHDAY.test(s.value)){alert('Ongeldig formaat voor geboortedatum');s.focus();return false};s=form.elements['data[pwd]'];if(EMPTY.test(s.value)){alert('Voer je wachtwoord in ter bevestiging');s.focus();return false};return true}
function checknewmessageform(form){if(!EMPTY.test(form.elements['data[content]'].value)){var checkImgResult=(form.elements['checkimg']&&!form.elements['checkimg'].checked)||checkImages(form);if(!checkImgResult)return false;if(!form.preview)trackEventWt('commentAdded',0,true)};return true}
function checknewtopicform(form){var s=form.elements['data[name]'];if(EMPTY.test(s.value)){alert('Geen titel opgegeven');s.focus();return false};if(s.value.length<10)if(!confirm('Je titel is wel erg kort; weet je zeker dat je dit wilt posten?')){s.focus();return false};s=form.elements['data[forumid]'];if(s&&!getSelectedValue(s)){alert('Je hebt geen forum gekozen');s.focus();return false};s=form.elements['data[content]'];if(EMPTY.test(s.value)){alert('Geen bericht opgegeven');s.focus();return false};var checkImgResult=(form.elements['checkimg']&&!form.elements['checkimg'].checked)||checkImages(form);if(!checkImgResult)return false;if(!form.preview){s=form.elements['data[prevtopicid]'];trackEventWt(s&&s.value?'forumtopicContinued':'forumtopicAdded',0,true)};return true}
function closeandsubmit(form){var o=form.elements['data[statusid]'];if(o.nodeName=='SELECT'){var i=o.options.length;while(i--)if(o.options[i].value=='Closed'){o.selectedIndex=i;break};getById('status').checked=true}else{o.value='Closed';form.elements['action'].value='frontend_admin'};form.elements['data[type]'].value='send';var submit=typeof form.onsubmit=='function'?form.onsubmit():true;if(submit!==false)form.submit()}
function toggle_radio(form,el){var radio=document.forms[form].elements[el];if(radio[0].checked){radio[1].checked=true}else radio[0].checked=true}
function scrolltoanchor(h){if(!h)h=window.location.hash;if(h!='')window.location.hash=h}
function setDefaultOption(select){var nd=-1;for(var o=select.options,i=0;i<o.length;i++)if(o[i].className=='defaultSelected'){nd=i;break}else if(nd==-1&&!o[i].getAttribute('disabled'))nd=i;if(nd>-1){select.selectedIndex=nd}else select.disabled=true};var SectionDisplayBehaviour=(function(){var icons=[['forumAdminIcon','images/icons/admin_open.gif','images/icons/admin_closed.gif'],['forumFieldsetIcon','images/icons/fieldset_open.gif','images/icons/fieldset_closed.gif'],['forumFieldsetIconTs','images/icons/fieldset_ts_open.gif','images/icons/fieldset_ts_closed.gif'],['forumAdminIconNew','images/icons/arrow_white_up.png','images/icons/arrow_white_down.png'],['forumFieldsetIconNew','images/icons/arrow_black_up.png','images/icons/arrow_black_down.png'],['forumFieldsetIconNewTs','images/icons/arrow_red_up.png','images/icons/arrow_red_down.png']],initSectionDisplayClick=function(el){skipCookieUpdate=true;do{if(typeof el.onclick=='function'){el.onclick();break}}while((el=el.parentNode));skipCookieUpdate=false},readCookie=function(){var c=getCookie('klipklapcookie'),temp,i,cookie={};if(c){temp=c.split(',');i=temp.length;while(i--)cookie[temp[i]]=1};return cookie},writeCookie=function(){var temp=[],id;for(id in cookie)if(cookie.hasOwnProperty(id))temp.push(id);setCookie('klipklapcookie',temp.join(','))},cookie=readCookie(),skipCookieUpdate=false;return{init:function(el){var i,j,k,base,icon;addClass(el,'pointer');el.title='in/uitklappen';if(el.nodeName=='IMG'){i=0;while((icon=icons[i++])){j=el.src.indexOf(icon[1]);k=el.src.indexOf(icon[2]);if(j>-1||k>-1){base=j>-1?el.src.substr(0,j):el.src.substr(0,k);el.iconId=icon[0];preload(icon[0]+'Hide',base+icon[1]);preload(icon[0]+'Show',base+icon[2]);break}}};if(el.id&&el.id in cookie)initSectionDisplayClick(el)},updateCookie:function(el,hide){if(skipCookieUpdate)return;if(hasClass(el,'kkRev'))hide=!hide;if(hide){cookie[el.id]=1}else delete cookie[el.id];writeCookie()}}})();if(window.BehaviourManager)BehaviourManager.register('.kk, .kkRev, .klipklap',SectionDisplayBehaviour.init)
function toggleSectionImage(img){var iconId=img.iconId?img.iconId:img.getAttribute('iconId'),hide=img.src==getPreloadImage(iconId+'Hide');img.src=getPreloadImage(iconId+(hide?'Show':'Hide'));if(img.id)SectionDisplayBehaviour.updateCookie(img,hide);return hide}
function toggleFieldsetDisplay(img,hideall){var hide=toggleSectionImage(img),fe=node_after(img.parentNode),fieldset=Set('DL','FIELDSET','TABLE','OL');do{if(hideall||fe.nodeName in fieldset)fe.style.display=hide?'none':''}while((fe=node_after(fe)))}
function toggle_channeldisplay(img){var forumList=TreeWalker(img).parentNode('.forumList');if(forumList){toggleClass(forumList,'hidden');SectionDisplayBehaviour.updateCookie(img,hasClass(forumList,'hidden'))}}
function toggle_categorydisplay(img){var hide=toggleSectionImage(img),tw=TreeWalker(img),row=tw.parentNode('TR');if(row){row.className=hide?'hide':'';while((row=tw.nextSibling('TR')))row.style.display=hide?'none':''}};var selectionTarget=null
function initMessageBox(isCrew){if(!(selectionTarget=getById('messageBox')))return;if(window.RmlToolBar)window.reactionFormToolbar=new RmlToolBar(selectionTarget,'horizontal','nl','forum',isCrew);selectionTarget.focus()};(function(acckeys,$h){if(!(acckeys||$h))return;document.onkeydown=function(e){e=e||event;var key=e.keyCode;if(acckeys&&e.altKey&&key>=65&&key<=90){var a=String.fromCharCode(key).toLowerCase();if(a in acckeys){window.location.href=/^https?:\/\//.test(acckeys[a])?acckeys[a]:jsConfig.get('board_script_url')+acckeys[a];return cancelEvent(e)}};if($h)464864785^($h=((1<<30)-1)&$h*8+key)||(function(){(getById('henk')||{}).className='show'})();return true}})(jsConfig.get('acckeys'),jsConfig.get('$h'));var toggle_userdata=(function(){var activePopup=null,first=true,open=function(e){if(activePopup==this)return;close();if(first){addEvent(document,'click',close);first=false};activePopup=this;addClass(activePopup,'visible');e.stopPropagation()},close=function(e){if(!activePopup)return;if(e&&e.target&&activePopup.contains(e.target)&&e.target!=activePopup)return;removeClass(activePopup,'visible');activePopup=null};return function(root){root=root||getById('content');if(root)Selector('.userklipklap',root).forEach(function(el){addClass(el,'pointer');addEvent(el,'click',open)})}})(),init_short_quotes=(function(){var handleClick=function(e){var quote=Selector('.large-quote',this.parentNode)[0];if(!quote)return;toggleClass(quote,'open');toggleClass(this,'collapsed');this.innerHTML=hasClass(this,'collapsed')?uncollapsedLabel:collapsedLabel},collapsedLabel='toon volledige bericht',uncollapsedLabel='toon ingeklapte bericht',maxHeight=300;return function(root){root=root||getById('content');if(root)Selector('.message-quote-div',root).forEach(function(el){if(el.offsetHeight<maxHeight)return;addClass(el,'large-quote');var toggleLink=document.createElement('span');toggleLink.className='toggle-quote';toggleLink.innerHTML=collapsedLabel;addEvent(toggleLink,'click',handleClick);el.parentNode.appendChild(toggleLink)})}})(),init_ratings=(function(){var handleClick=function(e){var target=e.target,messageId=this.getAttribute('data-messageid');if(!messageId)return;while(target&&target!=this){if(hasClass(target,'ratingcount')){if(hasClass(this,'has_ratings'))showRatings(messageId,target);return};if(hasClass(target,'thumbsup')){if(hasClass(this,'can_be_rated'))rateMessage(messageId,target);return};target=target.parentNode}},showRatings=function(messageId,counterElement){var popup=PopupGenerator.get('ratingPopup');if(!popup)return;if(popup.visible&&popup.options.getMessageId()==messageId){popup.close(true);return};popup.options.setMessageId(messageId);popup.show(counterElement)},rateMessage=function(messageId,thumbElement){var type=hasClass(thumbElement,'rated')?'unrate':'rate';removeClass(thumbElement.parentNode,'can_be_rated');Ajax.sendRequest(location.protocol+'//'+location.host+'/ajax/'+type+'_message/'+messageId,{method:'POST',type:'json',async:true,appendSid:true,handler:processRatingResult.bind(this,type,thumbElement)})},processRatingResult=function(type,thumbElement,response){var data=checkJsonResponse(response);if(!data)return;var result=setRatingCount(TreeWalker(thumbElement).previousSibling('.ratingcount'),parseInt(data.message_rating_count,10));if(result){if(type=='rate'){addClass(thumbElement,'rated');thumbElement.title='Verwijder thumbs-up'}else{removeClass(thumbElement,'rated');thumbElement.title='Geef thumbs-up'};addClass(thumbElement.parentNode,'can_be_rated')}},setRatingCount=function(counterElement,count){if(!(counterElement&&count!=null))return false;counterElement.firstChild.nodeValue=count?'+'+count:'0';if(count){addClass(counterElement.parentNode,'has_ratings')}else removeClass(counterElement.parentNode,'has_ratings');return true};if(window.PopupGenerator)PopupGenerator.register('ratingPopup',{offsetLeft:-45,offsetTop:6,arrow:'top',className:'dark',forceUpdate:true,messageId:null,setMessageId:function(messageId){this.messageId=messageId},getMessageId:function(){return this.messageId},getContent:function(popup){return this.sendRequest(popup)},sendRequest:function(popup){Ajax.sendRequest(location.protocol+'//'+location.host+'/ajax/list_messageratings/'+this.messageId,{method:'GET',type:'json',async:true,handler:this.handleResponse.bind(this,popup)});return popup.getLoadingMessage('Het overzicht wordt geladen...')},handleResponse:function(popup,response){var data=checkJsonResponse(response);if(!data){popup.close(true);return};if(!(Array.isArray(data)&&data.length)){popup.setContent('<p>Geen data gevonden...</p>');return};popup.setContent(this.createUserList(data));var scrollable=Selector('.ratingList',popup.element)[0];if(scrollable)Scrollable.create(scrollable,{lightcolor:1,nohorizontal:1});setRatingCount(this.offsetElement,data.length)},createUserList:function(userList){var html=[],i=0,userData;html.push('<div class="ratingList"><ul>');while((userData=userList[i++]))html.push('<li><a href="'+userData.rating_user_profilelink+'" target-"_blank">'+userData.rating_user_nickname+'</a></li>');html.push('</ul></div>');return html.join('')}});return function(root){if(pageIsInFrame())return;root=root||getById('content');if(root)Selector('.rating',root).forEach(function(el){addEvent(el,'click',handleClick)})}})(),init_qa=(function(){var handleClick=function(e){var messageId=this.getAttribute('data-messageid');if(!messageId)return;if(hasClass(this,'disabled'))return;acceptAnswer(messageId,this)},acceptAnswer=function(messageId,acceptButton){var type=hasClass(acceptButton,'accepted')?'unaccept':'accept';addClass(acceptButton,'disabled');Ajax.sendRequest(location.protocol+'//'+location.host+'/ajax/'+type+'_message_answer/'+messageId,{method:'POST',type:'json',async:true,appendSid:true,handler:processAnswerResult.bind(this,type,acceptButton)})},processAnswerResult=function(type,acceptButton,response){removeClass(acceptButton,'disabled');var data=checkJsonResponse(response);if(!(data&&data.result))return;Selector('.fancyButton.accepted').forEach(toggle);if(type=='accept')toggle(acceptButton);var example=Selector('h2.answer + .message')[0];if(example)example.style.opacity='.3';var tip=getById('acceptedAnswerTip');if(tip)tip.style.display=type=='accept'?'none':''},toggle=function(el){toggleClass(el,'accepted');toggleClass(el,'green');toggleClass(el,'darkGrey');var parent=el.parentNode;do{if(hasClass(parent,'message')){toggleClass(parent,'bestAnswer');break}}while((parent=parent.parentNode))};return function(root){if(pageIsInFrame())return;root=root||getById('content');if(root)Selector('.fancyButton.answer',root).forEach(function(el){addEvent(el,'click',handleClick)})}})()
function user_images(warning,root){if(warning)showwarning=true;Selector('img.rml',root).forEach(function(img){if(img.complete){scaleImage(0,img)}else img.onload=img.onerror=img.onabort=scaleImage})};var showwarning=false
function scaleImage(e,img){if(!img)img=this;img.onload=img.onerror=img.onabort=null;if(!img.complete)return;var imgwidth=0,imgheight=0;if(img.naturalWidth){imgwidth=img.naturalWidth;imgheight=img.naturalHeight}else{var dum=new Image();dum.src=img.src;imgwidth=dum.width;imgheight=dum.height};if(!(imgwidth&&imgheight))return;var contentDiv=img.parentNode;while(contentDiv&&contentDiv.clientWidth==0)contentDiv=contentDiv.parentNode;if(!contentDiv)return;var maxWidth=contentDiv.offsetWidth,inQuote=false,el;if(hasClass(contentDiv,'messagecontent')){maxWidth=contentDiv.parentNode.offsetWidth}else while(contentDiv&&!(inQuote=hasClass(contentDiv,'message-quote-div')))contentDiv=contentDiv.parentNode;if(imgwidth>maxWidth){maxWidth-=2;if(img.parentNode.nodeName!='A'){if(!img.naturalWidth)img.naturalWidth=imgwidth;if(!img.naturalHeight)img.naturalHeight=imgheight;img.className+=' resized pointer';img.onclick=openImage;el=img}else{img.className+=' resized2';el=img.parentNode};if(showwarning&&!/.svg$/i.test(img.src)&&imgwidth>1024&&!inQuote){var warning=document.createElement('div');warning.className='resizewarning';warning.style.width=((img.width<maxWidth?img.width:maxWidth)+2)+'px';warning.innerHTML='<div><small>Deze afbeelding is '+imgwidth+' * '+imgheight+' pixels'+(img.fileSize&&img.fileSize>0?' en '+Math.floor(img.fileSize/1024)+'KB':'')+' groot. Hier op GoT verwachten we dat je <em>echte</em> thumbnails maakt.<br>Kijk in de <a href="'+jsConfig.get('board_script_url')+'/faq/forumsurvival#images" onclick="window.open(this.href);return false">faq</a> als je niet weet hoe dit moet.</small></div>';el.parentNode.insertBefore(warning,el.nextSibling)}};if(img.width>maxWidth){if(img.height)img.height=Math.round(maxWidth/img.width*img.height);img.width=maxWidth}}
function openImage(){winopen(jsConfig.get('board_default_template_url')+'html/showimage.html?'+encodeURIComponent(this.src),'',Math.min(this.naturalWidth,screen.availWidth),Math.min(this.naturalHeight,screen.availHeight),'scrollbars=no,left=0,top=0')}
function code_tags(root){var el=Selector('table.phphighlight',root),i=0,table,row,div,pre,img,cw;while((table=el[i++])){row=table.rows[0];if(!(div=first_child(row.cells[row.cells.length-1],'div')))continue;div.style.paddingBottom='0px';pre=first_child(div);if(!pre||(pre.nodeName!='PRE'&&pre.nodeName!='CODE'))continue;cw=div.clientWidth;if(div.scrollWidth>cw){div.orgWidth=cw;if(Browser.is.ie){div.orgPadding=(div.scrollHeight-div.clientHeight)+'px';div.style.paddingBottom=div.orgPadding};pre.style.width=div.scrollWidth+'px';img=document.createElement('img');img.src='images/icons/arrow_black_up.png';img.className='klipklap pointer';img.onclick=klipklap_code;table.parentNode.insertBefore(img,node_before(node_before(table)))}};el=Selector('div.pre, div.cmd',root),i=0;while((div=el[i++])){div.style.paddingBottom='0px';if(!(pre=first_child(div,'pre')))continue;cw=div.clientWidth;if(div.scrollWidth>cw){div.orgWidth=cw;if(Browser.is.ie){div.orgPadding=(div.scrollHeight-div.clientHeight)+'px';div.style.paddingBottom=div.orgPadding};pre.style.width=div.scrollWidth+'px';img=document.createElement('img');img.src=getPreloadImage('forumFieldsetIconNewHide');img.className='klipklap pointer';img.onclick=klipklap_pre;div.parentNode.insertBefore(img,div)}}}
function klipklap_code(){var table=node_after(node_after(node_after(this)));if(!table||table.nodeName!='TABLE')return;var row=first_child(table);if(row.nodeName!='TR')row=first_child(row);var div=first_child(row.childNodes[row.childNodes.length-1]);if(!div||div.nodeName!='DIV')return;var pre=first_child(div);if(!pre||(pre.nodeName!='PRE'&&pre.nodeName!='CODE'))return;var showImage=getPreloadImage('forumFieldsetIconNewShow'),hideImage=getPreloadImage('forumFieldsetIconNewHide');if(this.src==hideImage){this.src=showImage;table.style.width='auto';div.style.overflow='visible';if(Browser.is.ie)div.style.paddingBottom='0px';pre.style.borderRight='1px solid black';div.style.width=pre.scrollWidth+'px'}else{this.src=hideImage;table.style.width='';div.style.overflow='';if(Browser.is.ie)div.style.paddingBottom=div.orgPadding;pre.style.borderRight='none';div.style.width=div.orgWidth+'px'}}
function klipklap_pre(){var div=node_after(this);if(!div||div.nodeName!='DIV')return;var pre=first_child(div);if(!pre||pre.nodeName!='PRE')return;var showImage=getPreloadImage('forumFieldsetIconNewShow'),hideImage=getPreloadImage('forumFieldsetIconNewHide');if(this.src==hideImage){this.src=showImage;div.style.overflow='visible';if(Browser.is.ie)div.style.paddingBottom='0px';div.style.width=pre.scrollWidth+'px'}else{this.src=hideImage;div.style.overflow='';if(Browser.is.ie)div.style.paddingBottom=div.orgPadding;div.style.width=div.orgWidth+'px'}}
function spoiler_tags(root){root=root||getById('content');if(root)Selector('.spoiler',root).forEach(function(el){el.onclick=toggle_spoiler})}
function toggle_spoiler(){toggleClass(this,'visible')}
function more_smilies(a){var m=getById('moresmilies');if(m)if(m.style.display=='none'){m.style.display='block';a.style.display='none'}}
function newMessageNotifier(topicId,lastMessageId,messageType,flipOrder,topicIsOld,filterData){var newMessages=[],notification=null,msgElement=null,timer=null,throttleCount=0,ajaxBusy=false,documentTitle=document.title
function getNewMessages(){if(!ajaxBusy){ajaxBusy=true;Ajax.sendRequest(location.protocol+'//'+location.host+'/ajax/list_new_messages/'+topicId+'/'+lastMessageId+(messageType?'/'+messageType:'')+(filterData?'?'+filterData:''),{method:'GET',type:'json',async:true,nocache:true,handler:processMessages})}}
function processMessages(response){if(response!==false)if('error'in response){updateNotification(response.error);RefreshTimer().remove('newMessageNotifier')}else if('data'in response){var data=response.data,notify=false,i=0;if('lastmessageid'in data){lastMessageId=data.lastmessageid;if('messages'in data&&data.messages.length){while((message=data.messages[i++]))newMessages.push(message);notify=true;if('lastposterid'in data)updateErrorMsg(data.lastposterid==jsConfig.get('UserID')?'lastposter':'none')}};if('status'in data&&data.status=='Closed')updateErrorMsg('closed');if(notify){updateNotification();throttleCount=0;timer.interval=10}else{throttleCount++;if(throttleCount==10){timer.interval=Math.min(Math.round(timer.interval*1.5),30);throttleCount=0}}};ajaxBusy=false}
function updateNotification(errorMsg){var newMessageCount=newMessages.length,c;if(newMessageCount||errorMsg){if(!notification){notification=document.createElement('div');notification.id='newMessageNotification';notification.onclick=showNewMessages;if((c=getById('newMessages')))c.appendChild(notification)};if(errorMsg){notification.innerHTML=errorMsg;notification.className='error'}else{notification.innerHTML=newMessageCount==1?'Er is 1 nieuwe reactie geplaatst':'Er zijn '+newMessageCount+' nieuwe reacties geplaatst';document.title='('+newMessageCount+') '+documentTitle};notification.style.display='block'}}
function showNewMessages(){if(notification){var message,stripped,el,jump2=false;while((message=newMessages.shift())){el=document.createElement('div');el.innerHTML=stripped=Ajax.stripScripts(message);if(messageType=='quote'&&!flipOrder){jump2=jump2||el;notification.parentNode.parentNode.appendChild(el)}else notification.parentNode.insertBefore(el,flipOrder?notification.nextSibling:notification);BehaviourManager.exec(el);messageBehaviourHandler.addBehaviour(el);if(stripped!=message)Ajax.evalScripts(message)};notification.style.display='none';document.title=documentTitle;if(jump2)window.scrollTo(window.pageXOffset||(document.documentElement||document.body).scrollLeft,getOffsetTop(jump2))}}
function updateErrorMsg(type){var form,message,warningImage='<img src="images/icons/alert.gif" alt="" height="13" width="13">';msgElement=msgElement||getById('topicStatusWarning');if(type=='none'){if(msgElement)msgElement.style.display='none';return};if(!msgElement||type=='lastposter'){var form=getById('quickreply_form');if(!form){if(type=='lastposter')return;form=getById('message_form')};if(!form)return;if(!msgElement){msgElement=document.createElement('div');msgElement.id='topicStatusWarning';msgElement.className='topicwarning';form.insertBefore(msgElement,form.firstChild)}};switch(type){case'closed':message='Dit topic is gesloten.';break;case'lastposter':message='Je hebt zelf als laatste gereageerd in dit topic. Wil je wat toevoegen, wijzig dan bij voorkeur je <a href="'+jsConfig.get('BaseURL')+'updatemessage/'+lastMessageId+'/last">laatste bericht</a>.';break;default:return updateErrorMsg('none')};msgElement.innerHTML='<p>'+warningImage+' <strong>'+message+'</strong> '+warningImage+'</p>';msgElement.style.display='block'};(function startTimer(){if(window.RefreshTimer)timer=RefreshTimer().add('newMessageNotifier',getNewMessages,topicIsOld?60:10)})()}
function TopicIgnoreManager(){function toggleIgnore(){var substrPosition=this.href.indexOf(':')+1;Ajax.sendRequest(location.protocol+this.href.substr(substrPosition).replace('/forum/','/ajax/'),{method:'POST',type:'json',async:true,appendSid:true});var tr=this.parentNode;while(tr){if(tr.nodeName=='TR'){if(hasClass(tr,'ignored')){removeClass(tr,'ignored');this.href=this.href.replace('/unignore_topic/','/ignore_topic/');this.firstChild.src=getPreloadImage('icon_delete');this.firstChild.title='verbergen'}else{addClass(tr,'ignored');this.href=this.href.replace('/ignore_topic/','/unignore_topic/');this.firstChild.src=getPreloadImage('icon_add');this.firstChild.title='weer tonen'};break};tr=tr.parentNode};return false};var board_static_url=jsConfig.get('board_static_url');preload('icon_add',board_static_url+'images/icons/add.png');preload('icon_delete',board_static_url+'images/icons/delete.png');Selector('td.ignore').forEach(function(td){td.firstChild.onclick=toggleIgnore})};var messageBehaviourHandler=(function(){var settings=null,additionalHandlers=[];return{init:function(initialSettings){this.setSettings(initialSettings||{});this.addBehaviour()},setSettings:function(newSettings){settings=newSettings},getSettings:function(){return settings},addBehaviour:function(root){toggle_userdata(root);if(settings){if(settings.images)user_images(settings.imagewarning,root);if(settings.code)code_tags(root);if(settings.spoilers)spoiler_tags(root);if(settings.short_quotes)init_short_quotes(root);if(settings.ratings)init_ratings(root);if(settings.answers)init_qa(root)};additionalHandlers.forEach(function(func){func(root)})},addHandler:function(func){additionalHandlers.push(func)}}})()
function checkImages(form){var IMGCHECK=/(\\+)?\[img((\s+=?|=)(([^\]'"`]|'[^']*'|"[^"]*"|`[^`]*`)*))?\]\s*(https?:\/\/)?(.*?)\s*\[\/(img)?\]/gi,ATTRCHECK=/\s+(\w+)(\s*=\s*(\w+|'[^']*'|"[^"]*"|`[^`]*`))?/g,IMGMAXWIDTH=800
function processMessage(message){if(!processbar){processbar=document.createElement('pre');processbar.className='processMessage';processbar.appendChild(document.createTextNode('tweakers.net:$ Plaatjes controleren...\r\n'));form.parentNode.style.position='relative';form.parentNode.appendChild(processbar);form.parentNode.scrollIntoView();addEvent(document,'keydown',keyHandler)};processbar.firstChild.nodeValue+=message;processbar.scrollTop=processbar.scrollHeight}
function keyHandler(e){if(e.keyCode==27){closeProcessBar()}else if(e.keyCode==13)submitForm()}
function closeProcessBar(){if(processbar)if(submitTimeout){clearTimeout(submitTimeout);submitTimeout=null;processMessage('\r\n\r\nVerwerking geannuleerd; druk op escape om aanpassingen ongedaan te maken of op enter om alsnog te verwerken...')}else{processbar.parentNode.removeChild(processbar);processbar=null;selectionTarget.value=oldmessage;toggleFormSubmits(false);removeEvent(document,'keydown',keyHandler);form=null}}
function imgLoaded(){if(this.completed)return;this.completed=1;var match=matches[this.matchIndex];if(!match)return;match[6]=this.src.startsWith('https://')?'https://':'http://';if(this.width&&this.height){processMessage('\r\nPlaatje '+this.src+' ingeladen; breedte: '+this.width+', hoogte: '+this.height);if(match.width){if(!match.height)match.height=Math.round((match.width/this.width)*this.height)}else if(match.height){if(!match.width)match.width=Math.round((match.height/this.height)*this.width)}else{match.width=this.width;match.height=this.height};if(match.width>IMGMAXWIDTH){processMessage('\r\nPlaatje is te breed; maximale breedte van '+IMGMAXWIDTH+' ingesteld!');match.height=Math.round((IMGMAXWIDTH/this.width)*this.height);match.width=IMGMAXWIDTH}}else processMessage('\r\nPlaatje '+this.src+' ingeladen, maar afmetingen konden niet worden bepaald!');this.completed=1}
function imgError(){processMessage('\r\nPlaatje '+this.src+' kon niet geladen worden!');if(this.src.startsWith('https://')){processMessage('\r\nProberen met http...');this.src='http://'+matches[this.matchIndex][7]}else this.completed=1}
function createImageTag(match){var imagetag,attr;if(match.width&&match.height){imagetag=(match[1]?match[1]:'')+'[img';if(match[4]){if(match[3].trim()=='='){match.attr[0]=match.width;match.attr[1]=match.height;imagetag+='='+match.attr.join(',')}else{match.attr['width']=match.width;match.attr['height']=match.height;for(attr in match.attr)if(!Object.prototype[attr])imagetag+=' '+attr+'='+match.attr[attr]}}else imagetag+='='+match.width+','+match.height;imagetag+=']'+match[6]+match[7]+'[/'+(match[8]||'')+']'}else imagetag=match[0];return imagetag};var timeout=100
function finalizeImages(){timeout-=1;if(timeout>0){var i=preload.length;if(i){while(i--)if(!preload[i].completed){if(preload[i].complete)imgLoaded.call(preload[i]);setTimeout(finalizeImages,100);return};processMessage('\r\n\r\nAlle plaatjes gecontroleerd; het bericht wordt aangepast...');preload=null,i=matches.length;var newmessage=selectionTarget.value;while(i--)if((j=newmessage.indexOf(matches[i][0]))>-1)newmessage=newmessage.substr(0,j)+createImageTag(matches[i])+newmessage.substr(j+matches[i][0].length);selectionTarget.value=newmessage};processMessage('\r\n\r\nKlaar :)')}else processMessage('\r\n\r\nMaximale tijd verstreken :(');processMessage('\r\n\r\nJe bericht wordt binnen 3 seconden verwerkt\r\nDruk op escape om dit te annuleren of op enter om je bericht meteen te plaatsen');finished=true;submitTimeout=window.setTimeout(submitForm,3e3)}
function toggleFormSubmits(disable){for(var i=0;i<form.elements.length;i++)if(form.elements[i].type=='submit'){if(disable)form.elements[i].blur();form.elements[i].disabled=disable}}
function submitForm(){if(finished){if(submitTimeout){clearTimeout(submitTimeout);submitTimeout=null};toggleFormSubmits(false);form.submit()}}
function trimQuotes(string){string=string.trim();if(string.charAt(0)=="'"||string.charAt(0)=='"')string=string.substring(1,string.length-1);return string};var matches=[],preload=[],processbar=null,submitTimeout=null,finished=false,i=0,j,match,attr;if(!(selectionTarget=selectionTarget||getById('messageBox')))return true;var oldmessage=selectionTarget.value;while((match=IMGCHECK.exec(oldmessage))){if(match[1]&&match[1].length%2)continue;match[7]=match[7].replace(/[ [\]]/g,encodeURIComponent);matches[i]=match;matches[i]['width']=0;matches[i]['height']=0;if(match[4])if(match[3].trim()=='='){matches[i]['attr']=[];matches[i]['attr']=match[4].split(',');if(matches[i]['attr'][0])matches[i]['width']=parseInt(trimQuotes(matches[i]['attr'][0]),10);if(matches[i]['attr'][1])matches[i]['height']=parseInt(trimQuotes(matches[i]['attr'][1]),10)}else{matches[i]['attr']={};while((attr=ATTRCHECK.exec(match[2])))matches[i]['attr'][attr[1]]=attr[3];if('nocheck'in matches[i]['attr'])continue;if(matches[i]['attr']['width'])matches[i]['width']=parseInt(trimQuotes(matches[i]['attr']['width']),10);if(matches[i]['attr']['height'])matches[i]['height']=parseInt(trimQuotes(matches[i]['attr']['height']),10)};i++};if(!i)return true;i=j=0;while((match=matches[i])){if(!match.width||!match.height||match[6]!='https://'){processMessage('\r\nDe volgende tag wordt gecontroleerd: '+match[0]);preload[j]=new Image();preload[j].matchIndex=i;preload[j].completed=0;preload[j].onload=imgLoaded;preload[j].onerror=imgError;preload[j].onabort=imgError;preload[j].src='https://'+match[7];j++}else if(match.width>IMGMAXWIDTH){processMessage('\r\nPlaatje is te breed; maximale breedte van '+IMGMAXWIDTH+' ingesteld!');matches[i]['height']=Math.round((IMGMAXWIDTH/match.width)*match.height);matches[i]['width']=IMGMAXWIDTH;preload[j]={completed:1};j++};i++};if(!j)return true;processMessage('\r\n');setTimeout(finalizeImages,100);toggleFormSubmits(true);return false}
function putStr(text){if(window.reactionFormToolbar)window.reactionFormToolbar.rteAction('plain',text)}
function changeTopicType(typeChoice){typeChoice.form.className=typeChoice.form.className.replace(/topicType\d/,'topicType'+typeChoice.value);Selector('.upperlabel',typeChoice.form).forEach(function(el){var typeLabel=el.getAttribute('data-type_label_'+typeChoice.value);if(typeLabel)el.innerHTML=typeLabel});if(!selectionTarget)return;if(selectionTarget.value!=selectionTarget.defaultValue)return;var tplName='data-topic_template_'+typeChoice.value;if(!selectionTarget.hasAttribute(tplName))return;selectionTarget.value=selectionTarget.getAttribute(tplName).replace(/\\([0nrt'/])/g,function(m){switch(m[1]){case'0':return'';case'n':return'\n';case'r':return'\r';case't':return'\t'};return m[1]});selectionTarget.defaultValue=selectionTarget.value}